Debugging ESP32 using arduino tools
hobby project notes 8.1.2020/pekka

https://hackaday.com/2017/03/30/the-2-32-bit-arduino-with-debugging/
https://youtu.be/D-MbC9N5U7o

Select from Arduino IDE
ST Link
Optimize, Debug

ESP32 build tools used with Arduino IDE: /home/john/.arduino15/packages/esp32/tools/xtensa-esp32-elf-gcc/1.22.0-80-g6c4433a-5.2.0/bin

Arduino IDE build folder: /tmp/arduino_build_176781
All source code in one big file like : /tmp/arduino_build_176781/sketch/simple_socket_client.ino.cpp


export MYTOOLPATH="/home/john/.arduino15/packages/esp32/tools/xtensa-esp32-elf-gcc/1.22.0-80-g6c4433a-5.2.0/bin"

/tmp/arduino_build_904888
${MYTOOLPATH}/xtensa-esp32-elf-gdb -ex "set serial baud 115200" -ex "target remote /dev/ttyUSB0" -ex interrupt simple_socket_client.ino.elf
${MYTOOLPATH}/xtensa-esp32-elf-gdb -ex "set serial baud 115200" -ex "target remote /dev/ttyUSB0" -ex -tui simple_socket_client.ino.elf


xtensa-esp32-elf-gdb -ex "set serial baud 115200" -ex "target remote /dev/ttyUSB0" -ex -tui .ino.elf 

cd to build folder, start exactly same gdb as used to compile:
/tmp/arduino_build_176781
/home/pekka/.arduino15/packages/STM32/tools/arm-none-eabi-gcc/6-2017-q2-update/bin/arm-none-eabi-gdb -tui WebServer.ino.elf
target extended-remote :1234
load
break osal_socket_accept
continueload
n
bt

GOT LOCKED UP?
- Download ST link utility on windows,
- I've run the ST-LINK Utility (on windows) and I went to Target > Option Bytes... > Disable Read Out Protection (combo box). Done, issue solved.

Debugging With visual Studio Code instead of Arduino ide
https://visualgdb.com/tutorials/arduino/esp32/

Attaching debuffer (no arduino)
https://www.youtube.com/watch?v=p63VEYS7ZUw
